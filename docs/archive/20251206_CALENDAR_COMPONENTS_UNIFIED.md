# ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆçµ±ä¸€å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ

## æ¦‚è¦

å—å…¥ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ç”¨ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤ºã‚’ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã‹ã‚‰å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ã„ã¦æ­£ã—ãè‰²åˆ†ã‘ã™ã‚‹ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã—ãŸã€‚

## ä¿®æ­£ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«

### 1. ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚«ãƒ¼ãƒ‰æœ¬ä½“

**ãƒ•ã‚¡ã‚¤ãƒ«**: `app/frontend/src/features/dashboard/ukeire/ui/cards/CalendarCard.tsx`

#### å¤‰æ›´å†…å®¹

- `UkeireCalendar`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†ã«å¤‰æ›´
- `convertToPayload`é–¢æ•°ã‚’è¿½åŠ ã—ã¦ã€`day_type`ã«åŸºã¥ã„ãŸæ­£ã—ã„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ¤å®šã‚’å®Ÿè£…
- å‡¡ä¾‹ãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚€å®Œå…¨ãªãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ

```typescript
// day_type ã«åŸºã¥ã„ã¦ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’åˆ¤å®š
if (d.day_type === "CLOSED" || d.is_company_closed) {
  status = "closed"; // ä¼‘æ¥­æ—¥ï¼ˆèµ¤ï¼‰
  label = "ä¼‘æ¥­æ—¥";
} else if (d.day_type === "RESERVATION" || d.is_holiday) {
  status = "holiday"; // æ—¥æ›œãƒ»ç¥æ—¥ï¼ˆãƒ”ãƒ³ã‚¯ï¼‰
  label = d.is_holiday ? "ç¥æ—¥" : "æ—¥æ›œ";
} else {
  status = "business"; // å–¶æ¥­æ—¥ï¼ˆç·‘ï¼‰
  label = undefined;
}
```

### 2. ã‚»ãƒ«è£…é£¾ãƒ­ã‚¸ãƒƒã‚¯

**ãƒ•ã‚¡ã‚¤ãƒ«**: `app/frontend/src/features/dashboard/ukeire/application/decorateCalendarCells.ts`

#### å¤‰æ›´å†…å®¹

- `day_type`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ä½¿ç”¨ã—ãŸæ­£ã—ã„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ¤å®šã‚’å®Ÿè£…
- å–¶æ¥­æ—¥ã«ã‚‚ç·‘è‰²ï¼ˆ#52c41aï¼‰ã‚’è¨­å®š
- ä¼‘æ¥­æ—¥ã®åˆ¤å®šã‚’è¿½åŠ ï¼ˆç¬¬2æ—¥æ›œæ—¥ãªã©ï¼‰

### 3. å‹å®šç¾©ã®æ‹¡å¼µ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `app/frontend/src/features/calendar/model/types.ts`

#### å¤‰æ›´å†…å®¹

- `CalendarDayDTO`å‹ã«ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®å…¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ 
- å¾Œæ–¹äº’æ›æ€§ã®ãŸã‚`date`ã¨`isHoliday`ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’æ®‹ã™

```typescript
export type CalendarDayDTO = {
  ddate: string;
  y: number;
  m: number;
  iso_year: number;
  iso_week: number;
  iso_dow: number;
  is_holiday: boolean;
  is_second_sunday: boolean;
  is_company_closed: boolean;
  day_type: string; // NORMAL, RESERVATION, CLOSED
  is_business: boolean;
  date?: string; // å¾Œæ–¹äº’æ›æ€§
  isHoliday?: boolean; // å¾Œæ–¹äº’æ›æ€§
};
```

### 4. HTTPãƒªãƒã‚¸ãƒˆãƒªã®ãƒãƒƒãƒ”ãƒ³ã‚°

**ãƒ•ã‚¡ã‚¤ãƒ«**: `app/frontend/src/features/dashboard/ukeire/application/adapters/calendar.http.repository.ts`

#### å¤‰æ›´å†…å®¹

- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‹ã‚‰è¿”ã•ã‚Œã‚‹å…¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ãƒãƒƒãƒ”ãƒ³ã‚°
- `day_type`ãªã©ã®é‡è¦ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ç¢ºå®Ÿã«ä¼æ’­

### 5. ãƒ¢ãƒƒã‚¯ãƒªãƒã‚¸ãƒˆãƒªã®æ”¹å–„

**ãƒ•ã‚¡ã‚¤ãƒ«**: `app/frontend/src/features/dashboard/ukeire/application/adapters/calendar.mock.repository.ts`

#### å¤‰æ›´å†…å®¹

- å®Œå…¨ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’è¿”ã™ã‚ˆã†ã«ä¿®æ­£
- æ—¥æ›œæ—¥ã€ç¬¬2æ—¥æ›œæ—¥ã€ç¥æ—¥ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
- é–‹ç™ºæ™‚ã«ã‚‚æ­£ã—ã„è¡¨ç¤ºã‚’ç¢ºèªå¯èƒ½

## ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹é€ 

```
InboundForecastDashboardPage (pages)
  â†“
CalendarCardUkeire (wrapper)
  â†“
CalendarCard (ukeireå°‚ç”¨)
  â†“ useUkeireCalendarVM
  â†“   â†“ decorateCalendarCells
  â†“   â†“
  â†“ CalendarRepositoryForUkeire (HTTP)
  â†“
UkeireCalendar (è¡¨ç¤ºã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ)
  â†“
CalendarCore (å…±é€šã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚³ã‚¢)
```

## è‰²ã®å®šç¾©

| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | day_type    | è‰²        | 16é€²æ•°  |
| ---------- | ----------- | --------- | ------- |
| å–¶æ¥­æ—¥     | NORMAL      | ğŸŸ¢ ç·‘     | #52c41a |
| æ—¥æ›œãƒ»ç¥æ—¥ | RESERVATION | ğŸ©· ãƒ”ãƒ³ã‚¯ | #ff85c0 |
| ä¼‘æ¥­æ—¥     | CLOSED      | ğŸ”´ èµ¤     | #cf1322 |
| å½“æ—¥       | -           | ğŸŸ¡ é»„è‰²   | #fadb14 |

## å‡¡ä¾‹è¡¨ç¤º

ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®ä¸Šéƒ¨ã«è¡¨ç¤ºã•ã‚Œã‚‹å‡¡ä¾‹ï¼š

```
ğŸŸ¢ å–¶æ¥­æ—¥ 23æ—¥ (15)
ğŸ©· æ—¥æ›œãƒ»ç¥æ—¥ 5æ—¥ (3)
ğŸ”´ ä¼‘æ¥­æ—¥ 3æ—¥ (2)
```

- **ç·æ—¥æ•°**: ãã®æœˆã®è©²å½“æ—¥æ•°
- **æ®‹ã‚Šæ—¥æ•°**: ä»Šæ—¥ä»¥é™ã®è©²å½“æ—¥æ•°ï¼ˆæ‹¬å¼§å†…ï¼‰

## ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

1. **ãƒšãƒ¼ã‚¸ãƒ¬ãƒ™ãƒ«** (`InboundForecastDashboardPage`)

   - å¹´æœˆã‚’ç®¡ç†
   - `CalendarCardUkeire`ã‚’è¡¨ç¤º

2. **ãƒ©ãƒƒãƒ‘ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ** (`CalendarCard.Ukeire`)

   - ãƒªãƒã‚¸ãƒˆãƒªã‚’æ³¨å…¥ï¼ˆHTTPã¾ãŸã¯Mockï¼‰
   - `CalendarCard`ã«å§”è­²

3. **ã‚«ãƒ¼ãƒ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ** (`CalendarCard`)

   - `useUkeireCalendarVM`ã§ãƒ‡ãƒ¼ã‚¿å–å¾—
   - `convertToPayload`ã§ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰å¤‰æ›
   - `UkeireCalendar`ã«è¡¨ç¤ºã‚’å§”è­²

4. **ViewModelãƒ•ãƒƒã‚¯** (`useUkeireCalendarVM`)

   - åŸºæœ¬çš„ãªã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼VMå–å¾—
   - `decorateCalendarCells`ã§è£…é£¾è¿½åŠ 

5. **ãƒªãƒã‚¸ãƒˆãƒª** (`CalendarRepositoryForUkeire`)

   - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—
   - å…¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ãƒãƒƒãƒ”ãƒ³ã‚°

6. **è¡¨ç¤ºã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ** (`UkeireCalendar`)
   - ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’å—ã‘å–ã‚Š
   - `CalendarCore`ã§ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
   - å½“æ—¥ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’é©ç”¨

## å…±é€šã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¨ã®é–¢ä¿‚

### features/calendar (å…±é€š)

- `CalendarCore` - æ±ç”¨ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚³ã‚¢UI
- `useCalendarVM` - åŸºæœ¬çš„ãªã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ­ã‚¸ãƒƒã‚¯
- `CalendarCard` - æ±ç”¨ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚«ãƒ¼ãƒ‰ï¼ˆä»–æ©Ÿèƒ½ã§ä½¿ç”¨å¯èƒ½ï¼‰

### features/dashboard/ukeire (å—å…¥å°‚ç”¨)

- `CalendarCard` - å—å…¥ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰å°‚ç”¨ã‚«ãƒ¼ãƒ‰
- `useUkeireCalendarVM` - å—å…¥å°‚ç”¨ã®VMæ‹¡å¼µ
- `decorateCalendarCells` - å—å…¥å°‚ç”¨ã®è£…é£¾ãƒ­ã‚¸ãƒƒã‚¯
- `UkeireCalendar` - å—å…¥å°‚ç”¨ã®è¡¨ç¤ºã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

**è¨­è¨ˆæ–¹é‡**: å…±é€šéƒ¨åˆ†ã¯`features/calendar`ã«ã€å—å…¥å›ºæœ‰ã®ãƒ­ã‚¸ãƒƒã‚¯ã¯`features/dashboard/ukeire`ã«é…ç½®ã€‚

## ãƒ†ã‚¹ãƒˆæ–¹æ³•

### é–‹ç™ºç’°å¢ƒ

```bash
# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰èµ·å‹•ï¼ˆã™ã§ã«èµ·å‹•æ¸ˆã¿ï¼‰
cd app/frontend
npm run dev
```

### ç¢ºèªé …ç›®

1. âœ… å–¶æ¥­æ—¥ãŒç·‘è‰²ã§è¡¨ç¤ºã•ã‚Œã‚‹
2. âœ… æ—¥æ›œæ—¥ãŒãƒ”ãƒ³ã‚¯è‰²ã§è¡¨ç¤ºã•ã‚Œã‚‹
3. âœ… ç¥æ—¥ãŒãƒ”ãƒ³ã‚¯è‰²ã§ã€Œç¥æ—¥ã€ãƒ©ãƒ™ãƒ«ä»˜ãã§è¡¨ç¤ºã•ã‚Œã‚‹
4. âœ… ç¬¬2æ—¥æ›œæ—¥ãŒèµ¤è‰²ã§ã€Œä¼‘æ¥­æ—¥ã€ãƒ©ãƒ™ãƒ«ä»˜ãã§è¡¨ç¤ºã•ã‚Œã‚‹
5. âœ… å½“æ—¥ãŒé»„è‰²ã§ãƒã‚¤ãƒ©ã‚¤ãƒˆã•ã‚Œã‚‹
6. âœ… å‡¡ä¾‹ã«æ­£ã—ã„æ—¥æ•°ã¨æ®‹ã‚Šæ—¥æ•°ãŒè¡¨ç¤ºã•ã‚Œã‚‹

### ãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰

é–‹ç™ºä¸­ã«ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã§ç¢ºèªã™ã‚‹å ´åˆï¼š

```tsx
<CalendarCardUkeire year={2025} month={10} useMock={true} />
```

## å¾Œæ–¹äº’æ›æ€§

æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã¨ã®äº’æ›æ€§ã‚’ä¿ã¤ãŸã‚ï¼š

- `date`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯`ddate`ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹
- `isHoliday`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯è¨ˆç®—ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ã—ã¦æä¾›
- æ—§å½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ã‚‚è¡¨ç¤ºå¯èƒ½

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### è‰²ãŒè¡¨ç¤ºã•ã‚Œãªã„

- ãƒ–ãƒ©ã‚¦ã‚¶ã®DevToolsã§ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¿ãƒ–ã‚’ç¢ºèª
- `/core_api/calendar/month?year=YYYY&month=MM`ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ç¢ºèª
- `day_type`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

### ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ããªã„

- core_apiãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª: `http://localhost:8003/api/healthz`
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèªï¼ˆ2025-2026å¹´ï¼‰

### ãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰ãŒå‹•ä½œã—ãªã„

- `useMock={true}`ãƒ—ãƒ­ãƒƒãƒ—ã‚’ç¢ºèª
- ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª

---

**ä¿®æ­£æ—¥**: 2025-10-20  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… å®Œäº†ãƒ»çµ±åˆæ¸ˆã¿
