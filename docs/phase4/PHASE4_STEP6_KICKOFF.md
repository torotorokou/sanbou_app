# Phase 4 Step 6: Chatæ©Ÿèƒ½ã®ç§»è¡Œ

**ä½œæˆæ—¥**: 2025-01-05  
**Phase**: 4  
**Step**: 6  
**æ‹…å½“**: Migration Team

---

## ğŸ“‹ æ¦‚è¦

**ç›®çš„**: Chatæ©Ÿèƒ½ã‚’Feature-Sliced Designæ§‹é€ ã«å®Œå…¨ç§»è¡Œ

**èƒŒæ™¯**: 
- Phase 4ã§Reportã€Databaseã€Manualæ©Ÿèƒ½ã®ç§»è¡Œã‚’å®Œäº†
- Chatæ©Ÿèƒ½ã¯AIè³ªå•å¿œç­”ãƒ»PDFãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½ã‚’æä¾›
- UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ9ãƒ•ã‚¡ã‚¤ãƒ« + APIã‚µãƒ¼ãƒ“ã‚¹1ãƒ•ã‚¡ã‚¤ãƒ«ã§æ§‹æˆ

**ã‚¹ã‚³ãƒ¼ãƒ—**:
- UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ (9ãƒ•ã‚¡ã‚¤ãƒ«)
- APIã‚µãƒ¼ãƒ“ã‚¹ (1ãƒ•ã‚¡ã‚¤ãƒ«)
- åˆè¨ˆ: 10ãƒ•ã‚¡ã‚¤ãƒ«

---

## ğŸ¯ ç›®æ¨™

### ä¸»è¦ç›®æ¨™
1. **UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ç§»è¡Œ**: `components/chat/` â†’ `features/chat/ui/`
2. **APIã‚µãƒ¼ãƒ“ã‚¹ã®ç§»è¡Œ**: `services/chatService.ts` â†’ `features/chat/api/`
3. **å…¬é–‹APIä½œæˆ**: `features/chat/index.ts`
4. **ã‚³ãƒ³ã‚·ãƒ¥ãƒ¼ãƒãƒ¼æ›´æ–°**: 1ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

### å‰¯æ¬¡çš„ç›®æ¨™
- ãƒ“ãƒ«ãƒ‰æ™‚é–“ã®ç¶­æŒ (< 10ç§’)
- å‹ã‚¨ãƒ©ãƒ¼0ä»¶
- æ˜ç¢ºãªAPIå¢ƒç•Œã®ç¢ºç«‹

---

## ğŸ“Š ç¾çŠ¶åˆ†æ

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

**ç¾åœ¨ã®é…ç½®**:
```
src/
â”œâ”€â”€ components/
â”‚   â””â”€â”€ chat/
â”‚       â”œâ”€â”€ AnswerViewer.tsx              # å›ç­”è¡¨ç¤º
â”‚       â”œâ”€â”€ ChatAnswerSection.tsx         # å›ç­”ã‚»ã‚¯ã‚·ãƒ§ãƒ³
â”‚       â”œâ”€â”€ ChatMessageCard.tsx           # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚«ãƒ¼ãƒ‰
â”‚       â”œâ”€â”€ ChatQuestionSection.tsx       # è³ªå•ã‚»ã‚¯ã‚·ãƒ§ãƒ³
â”‚       â”œâ”€â”€ ChatSendButtonSection.tsx     # é€ä¿¡ãƒœã‚¿ãƒ³
â”‚       â”œâ”€â”€ PdfCardList.tsx               # PDFã‚«ãƒ¼ãƒ‰ãƒªã‚¹ãƒˆ
â”‚       â”œâ”€â”€ PdfPreviewModal.tsx           # PDFãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
â”‚       â”œâ”€â”€ QuestionPanel.css             # ã‚¹ã‚¿ã‚¤ãƒ«
â”‚       â””â”€â”€ QuestionPanel.tsx             # è³ªå•ãƒ‘ãƒãƒ«
â””â”€â”€ services/
    â””â”€â”€ chatService.ts                    # Chat APIã‚µãƒ¼ãƒ“ã‚¹
```

**ç§»è¡Œå¾Œã®é…ç½®**:
```
src/features/chat/
â”œâ”€â”€ api/
â”‚   â””â”€â”€ chatService.ts                    # APIã‚µãƒ¼ãƒ“ã‚¹
â”œâ”€â”€ ui/
â”‚   â”œâ”€â”€ AnswerViewer.tsx
â”‚   â”œâ”€â”€ ChatAnswerSection.tsx
â”‚   â”œâ”€â”€ ChatMessageCard.tsx
â”‚   â”œâ”€â”€ ChatQuestionSection.tsx
â”‚   â”œâ”€â”€ ChatSendButtonSection.tsx
â”‚   â”œâ”€â”€ PdfCardList.tsx
â”‚   â”œâ”€â”€ PdfPreviewModal.tsx
â”‚   â”œâ”€â”€ QuestionPanel.css
â”‚   â””â”€â”€ QuestionPanel.tsx
â””â”€â”€ index.ts                              # å…¬é–‹API
```

### ã‚³ãƒ³ã‚·ãƒ¥ãƒ¼ãƒãƒ¼åˆ†æ

**å½±éŸ¿ã‚’å—ã‘ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«** (1ãƒ•ã‚¡ã‚¤ãƒ«):
1. `pages/navi/SolvestNavi.tsx`
   - 4ã¤ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

**å†…éƒ¨ä¾å­˜é–¢ä¿‚** (2ãƒ•ã‚¡ã‚¤ãƒ«):
1. `ChatAnswerSection.tsx` â†’ `AnswerViewer.tsx`
2. `ChatQuestionSection.tsx` â†’ `QuestionPanel.tsx`

**ä¾å­˜é–¢ä¿‚**:
- `@shared/infrastructure/http` (HTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ)
- `@shared/utils` (PDFãƒ¯ãƒ¼ã‚«ãƒ¼)
- Ant Design UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

---

## ğŸ“ å®Ÿæ–½è¨ˆç”»

### Step 6-1: APIã‚µãƒ¼ãƒ“ã‚¹ã®ç§»è¡Œ âœ… (æœ€åˆ)

**ç†ç”±**: UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒAPIã‚µãƒ¼ãƒ“ã‚¹ã«ä¾å­˜ã™ã‚‹å¯èƒ½æ€§

**ã‚¿ã‚¹ã‚¯**:
- [ ] `services/chatService.ts` ã‚’ `features/chat/api/chatService.ts` ã«ã‚³ãƒ”ãƒ¼
- [ ] ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹ç¢ºèª
- [ ] å…¬é–‹APIä½œæˆ
- [ ] ãƒ“ãƒ«ãƒ‰ç¢ºèª

**äºˆæƒ³æ™‚é–“**: 10åˆ†

---

### Step 6-2: UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ç§»è¡Œ

**ç†ç”±**: Chatæ©Ÿèƒ½ã®ä¸»è¦éƒ¨åˆ†

**ã‚¿ã‚¹ã‚¯**:
- [ ] `components/chat/` ã‚’ `features/chat/ui/` ã«ã‚³ãƒ”ãƒ¼ (9ãƒ•ã‚¡ã‚¤ãƒ«)
- [ ] å†…éƒ¨ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹ä¿®æ­£
  - `@/components/chat/` â†’ ç›¸å¯¾ãƒ‘ã‚¹ (`./`)
- [ ] å…¬é–‹APIã«è¿½åŠ  (å¿…è¦ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã¿)
- [ ] ãƒ“ãƒ«ãƒ‰ç¢ºèª

**äºˆæƒ³æ™‚é–“**: 20åˆ†

---

### Step 6-3: ã‚³ãƒ³ã‚·ãƒ¥ãƒ¼ãƒãƒ¼æ›´æ–°

**ã‚¿ã‚¹ã‚¯**:
- [ ] `pages/navi/SolvestNavi.tsx` ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ›´æ–°
  - `@/components/chat/` â†’ `@features/chat`
- [ ] ãƒ“ãƒ«ãƒ‰ç¢ºèª
- [ ] æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ

**äºˆæƒ³æ™‚é–“**: 10åˆ†

---

### Step 6-4: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ

**ã‚¿ã‚¹ã‚¯**:
- [ ] `PHASE4_STEP6_COMPLETION.md` ä½œæˆ
- [ ] `MIGRATION_STATUS.md` æ›´æ–°
- [ ] ã‚³ãƒŸãƒƒãƒˆ

**äºˆæƒ³æ™‚é–“**: 15åˆ†

---

## ğŸ” äºˆæƒ³ã•ã‚Œã‚‹èª²é¡Œ

### èª²é¡Œ1: å†…éƒ¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä¾å­˜

**çŠ¶æ³**: 
- `ChatAnswerSection` â†’ `AnswerViewer`
- `ChatQuestionSection` â†’ `QuestionPanel`

**å¯¾ç­–**:
- ç›¸å¯¾ãƒ‘ã‚¹ã§å‚ç…§ (`./AnswerViewer`, `./QuestionPanel`)
- ã¾ãŸã¯å…¬é–‹APIã‹ã‚‰å‚ç…§

**ãƒªã‚¹ã‚¯**: ä½

---

### èª²é¡Œ2: CSSãƒ•ã‚¡ã‚¤ãƒ«ã®å–ã‚Šæ‰±ã„

**çŠ¶æ³**: `QuestionPanel.css`ãŒå­˜åœ¨

**å¯¾ç­–**:
- CSSãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ä¸€ç·’ã«ç§»è¡Œ
- ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹ã¯ç›¸å¯¾ãƒ‘ã‚¹ãªã®ã§ä¿®æ­£ä¸è¦

**ãƒªã‚¹ã‚¯**: ä½

---

### èª²é¡Œ3: PDFãƒ¯ãƒ¼ã‚«ãƒ¼ä¾å­˜

**çŠ¶æ³**: `PdfPreviewModal`ãŒ`@shared/utils/pdfWorkerLoader`ã«ä¾å­˜

**å¯¾ç­–**:
- æ—¢ã«`@shared`ã«ç§»è¡Œæ¸ˆã¿ãªã®ã§å•é¡Œãªã—
- ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹ã‚’ç¢ºèªãƒ»ç¶­æŒ

**ãƒªã‚¹ã‚¯**: ä½

---

## âœ… æ¤œè¨¼è¨ˆç”»

### ãƒ“ãƒ«ãƒ‰æ¤œè¨¼
```bash
npm run build
# æœŸå¾…: ã‚¨ãƒ©ãƒ¼0ä»¶ã€è­¦å‘Šã¯æ—¢çŸ¥ã®ã‚‚ã®ã®ã¿
# ç›®æ¨™: < 10ç§’
```

### å‹ãƒã‚§ãƒƒã‚¯
```bash
npm run type-check  # ã¾ãŸã¯ tsc --noEmit
# æœŸå¾…: ã‚¨ãƒ©ãƒ¼0ä»¶
```

### æ©Ÿèƒ½æ¤œè¨¼
1. ãƒãƒ£ãƒƒãƒˆãƒšãƒ¼ã‚¸ã‚¢ã‚¯ã‚»ã‚¹
2. è³ªå•å…¥åŠ›
3. å›ç­”è¡¨ç¤º
4. PDFãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
5. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè³ªå•é¸æŠ

---

## ğŸ“¦ æœŸå¾…ã•ã‚Œã‚‹æˆæœç‰©

### ã‚³ãƒ¼ãƒ‰
1. `src/features/chat/` (å®Œå…¨ãªFSDæ§‹é€ )
2. `src/features/chat/index.ts` (å…¬é–‹API)
3. æ›´æ–°ã•ã‚ŒãŸ `pages/navi/SolvestNavi.tsx`

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
1. `PHASE4_STEP6_COMPLETION.md`
2. æ›´æ–°ã•ã‚ŒãŸ `MIGRATION_STATUS.md`

### çµ±è¨ˆ
- ç§»è¡Œãƒ•ã‚¡ã‚¤ãƒ«æ•°: 10
- ã‚³ãƒ³ã‚·ãƒ¥ãƒ¼ãƒãƒ¼æ›´æ–°: 1ãƒ•ã‚¡ã‚¤ãƒ«
- å…¬é–‹API: ~5ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ (ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã¿)
- æ¨å®šã‚³ãƒ¼ãƒ‰è¡Œæ•°: ~800è¡Œ

---

## ğŸ“ å‰å›ã®ç§»è¡Œã‹ã‚‰ã®å­¦ã³

### é©ç”¨ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³

1. **æ®µéšçš„ç§»è¡Œ**:
   - API â†’ UI ã®é †
   - å„ã‚¹ãƒ†ãƒƒãƒ—ã§ãƒ“ãƒ«ãƒ‰ç¢ºèª

2. **ç›¸å¯¾ãƒ‘ã‚¹ vs çµ¶å¯¾ãƒ‘ã‚¹**:
   - åŒä¸€featureå†…: ç›¸å¯¾ãƒ‘ã‚¹
   - ä»–feature/shared: çµ¶å¯¾ãƒ‘ã‚¹

3. **å…¬é–‹API**:
   - å¤–éƒ¨ã‹ã‚‰ä½¿ç”¨ã•ã‚Œã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
   - å†…éƒ¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯éå…¬é–‹

### å‰å›ç§»è¡Œã¨ã®æ¯”è¼ƒ

| é …ç›® | Report | Database | Manual | Chat |
|------|--------|----------|--------|------|
| ãƒ•ã‚¡ã‚¤ãƒ«æ•° | 34 | 7 | 2 | 10 |
| è¤‡é›‘åº¦ | é«˜ | ä½ | éå¸¸ã«ä½ | ä¸­ |
| æ‰€è¦æ™‚é–“ | 6æ™‚é–“ | 30åˆ† | 20åˆ† | 40åˆ†(äºˆæƒ³) |

---

## ğŸš€ å®Ÿè¡Œæ‰‹é †

### ãƒ–ãƒ©ãƒ³ãƒä½œæˆ
```bash
git checkout -b phase4/step6-chat
```

### Step-by-Stepã‚¬ã‚¤ãƒ‰

#### Step 6-1: APIã‚µãƒ¼ãƒ“ã‚¹ç§»è¡Œ
```bash
# ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
mkdir -p src/features/chat/api

# ãƒ•ã‚¡ã‚¤ãƒ«ã‚³ãƒ”ãƒ¼
cp src/services/chatService.ts src/features/chat/api/

# å…¬é–‹APIä½œæˆ
cat > src/features/chat/index.ts << 'EOF'
// API
export * from './api/chatService';
EOF

# ãƒ“ãƒ«ãƒ‰ç¢ºèª
npm run build
```

#### Step 6-2: UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆç§»è¡Œ
```bash
# ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
mkdir -p src/features/chat/ui

# ãƒ•ã‚¡ã‚¤ãƒ«ã‚³ãƒ”ãƒ¼
cp -r src/components/chat/* src/features/chat/ui/

# ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹ä¿®æ­£
# (ã‚¨ãƒ‡ã‚£ã‚¿ã§å®Ÿæ–½)

# å…¬é–‹APIæ›´æ–°
# (ã‚¨ãƒ‡ã‚£ã‚¿ã§å®Ÿæ–½)

# ãƒ“ãƒ«ãƒ‰ç¢ºèª
npm run build
```

#### Step 6-3: ã‚³ãƒ³ã‚·ãƒ¥ãƒ¼ãƒãƒ¼æ›´æ–°
```bash
# ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹ä¸€æ‹¬ç½®æ›
# @/components/chat/ â†’ @features/chat

# ãƒ“ãƒ«ãƒ‰ç¢ºèª
npm run build
```

#### Step 6-4: å®Œäº†å‡¦ç†
```bash
# ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ
# (ã‚¨ãƒ‡ã‚£ã‚¿ã§å®Ÿæ–½)

# ã‚³ãƒŸãƒƒãƒˆ
git add src/features/chat docs/phase4/
git commit -m "feat(phase4): complete Step 6 - migrate Chat feature to FSD"
```

---

## ğŸ“š å‚è€ƒè³‡æ–™

- [PHASE4_STEP5_COMPLETION.md](./PHASE4_STEP5_COMPLETION.md) - Manualç§»è¡Œã®å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ
- [PHASE4_STEP4_COMPLETION.md](./PHASE4_STEP4_COMPLETION.md) - Databaseç§»è¡Œã®å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ
- [Feature-Sliced Design](https://feature-sliced.design/) - å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

---

## ğŸ“… ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

| ã‚¹ãƒ†ãƒƒãƒ— | äºˆæƒ³æ™‚é–“ | é–‹å§‹äºˆå®š | å®Œäº†äºˆå®š |
|---------|---------|---------|---------|
| Step 6-1 | 10åˆ† | 17:15 | 17:25 |
| Step 6-2 | 20åˆ† | 17:25 | 17:45 |
| Step 6-3 | 10åˆ† | 17:45 | 17:55 |
| Step 6-4 | 15åˆ† | 17:55 | 18:10 |
| **åˆè¨ˆ** | **55åˆ†** | **17:15** | **18:10** |

---

## âœï¸ æ‰¿èª

- [ ] ã‚­ãƒƒã‚¯ã‚ªãƒ•ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆå®Œäº†
- [ ] å®Ÿæ–½è¨ˆç”»ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Œäº†
- [ ] ãƒªã‚¹ã‚¯è©•ä¾¡å®Œäº†
- [ ] å®Ÿè¡Œæº–å‚™å®Œäº†

**ä½œæˆæ—¥**: 2025-01-05  
**æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**: Step 6-1å®Ÿè¡Œ (APIã‚µãƒ¼ãƒ“ã‚¹ã®ç§»è¡Œ)

---

**Ready to Start! ğŸš€**

Chatæ©Ÿèƒ½ã®ç§»è¡Œã¯ã€ä¸­è¦æ¨¡ã®featureã§ã€UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå¤šã„ã§ã™ãŒã€ä¾å­˜é–¢ä¿‚ã¯ã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã€‚ã“ã‚Œã¾ã§ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é©ç”¨ã—ã¦ã€ã‚¹ãƒ ãƒ¼ã‚ºã«ç§»è¡Œã‚’å®Œäº†ã™ã‚‹è¦‹è¾¼ã¿ã§ã™ã€‚
