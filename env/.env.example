###############################################
# .env.example (環境変数設定のサンプル)
# - 実際の値は各環境の .env ファイルとシークレットファイルに設定してください
# - このファイルはGit管理されます。実際の値は記載しないでください
###############################################

# === 環境設定の構成 ===
# .env.common         : 全環境共通設定（Git管理）
# .env.<env>          : 環境別設定（Git管理）
# secrets/.env.<env>.secrets : パスワード・APIキー（Git管理外）
#
# 読み込み順序: .env.common → .env.<env> → secrets/.env.<env>.secrets
#
# 【重要】DB ユーザー分離対応について
# - POSTGRES_USER / POSTGRES_PASSWORD は secrets/.env.*.secrets に記載してください
# - 環境別の専用ユーザーを使用してください：
#   * 開発: sanbou_app_dev
#   * ステージング: sanbou_app_stg
#   * 本番: sanbou_app_prod
# - 詳細は docs/db/20251204_db_user_design.md を参照

# ==== 共通設定 (.env.common) =================================================
# DB 接続（環境別に上書き）
POSTGRES_USER=__SET_IN_ENV_SPECIFIC_FILE__
POSTGRES_PASSWORD=__SET_IN_ENV_SPECIFIC_FILE__
POSTGRES_HOST=db
POSTGRES_PORT=5432

# アプリケーション基底設定
APP_ROOT_DIR=/backend
PYTHONPATH=${APP_ROOT_DIR}
APP_BASE_DIR=${APP_ROOT_DIR}

# API エンドポイント（Docker Compose 内部通信）
RAG_API_BASE=http://rag_api:8000
LEDGER_API_BASE=http://ledger_api:8000
MANUAL_API_BASE=http://manual_api:8000
AI_API_BASE=http://ai_api:8000
CORE_API_INTERNAL_URL=http://core_api:8000

# セキュリティ設定
DEBUG=false
IAP_ENABLED=false
IAP_AUDIENCE=

# API Keys（secrets ファイルで設定）
OPENAI_API_KEY=
GEMINI_API_KEY=

# ledger_api 設定
BASE_ST_APP_DIR=${APP_ROOT_DIR}/app/st_app
LEDGER_SYNC_SUBDIRS=master,templates

# ==== 開発環境 (.env.local_dev) ==============================================
APP_TAG=local_dev
STAGE=dev
NODE_ENV=development
PUBLIC_BASE_URL=http://localhost:5173

# DB 接続（secrets/.env.local_dev.secrets に記載）
POSTGRES_DB=sanbou_dev
# DATABASE_URL=postgresql://sanbou_app_dev:<PASSWORD>@db:5432/sanbou_dev

# セキュリティ
DEBUG=true
IAP_ENABLED=false

# GCS 同期
STARTUP_DOWNLOAD_ENABLE=false
STRICT_STARTUP=false
GCS_LEDGER_BUCKET_DEV=gs://sanbouapp-dev/ledger_api/st_app

# 開発用ポート
DEV_FRONTEND_PORT=5173
DEV_AI_API_PORT=8001
DEV_LEDGER_API_PORT=8002
DEV_CORE_API_PORT=8003
DEV_RAG_API_PORT=8004
DEV_MANUAL_API_PORT=8005
DEV_DB_PORT=5432

# ==== ローカルSTG環境 (.env.local_stg) =======================================
APP_TAG=local_stg
STAGE=stg
NODE_ENV=staging
PUBLIC_BASE_URL=http://stg.local

# DB 接続（secrets/.env.local_stg.secrets に記載）
POSTGRES_DB=sanbou_stg
# DATABASE_URL=postgresql://sanbou_app_stg:<PASSWORD>@db:5432/sanbou_stg

# セキュリティ
DEBUG=false
IAP_ENABLED=false

# GCS 同期
STARTUP_DOWNLOAD_ENABLE=True
STRICT_STARTUP=false
GCS_LEDGER_BUCKET_STG=gs://sanbouapp-stg/ledger_api/st_app

# Nginx ポート
STG_NGINX_HTTP_PORT=18080
STG_NGINX_HTTPS_PORT=18443

# ==== VM STG環境 (.env.vm_stg) ===============================================
APP_TAG=stg
STAGE=stg
NODE_ENV=staging
PUBLIC_BASE_URL=https://stg.sanbou-app.jp

# DB 接続（secrets/.env.vm_stg.secrets に記載）
POSTGRES_DB=sanbou_stg
# DATABASE_URL=postgresql://sanbou_app_stg:<PASSWORD>@db:5432/sanbou_stg

# セキュリティ
DEBUG=false
IAP_ENABLED=true
# IAP_AUDIENCE=/projects/PROJECT_NUMBER/global/backendServices/SERVICE_ID

# GCS 同期
STARTUP_DOWNLOAD_ENABLE=True
STRICT_STARTUP=false
GCS_LEDGER_BUCKET_STG=gs://sanbouapp-stg/ledger_api/st_app

# Nginx ポート
STG_NGINX_HTTP_PORT=8080
STG_NGINX_HTTPS_PORT=8443

# ==== VM 本番環境 (.env.vm_prod) =============================================
APP_TAG=prod
STAGE=prod
NODE_ENV=production
PUBLIC_BASE_URL=https://sanbou-app.jp

# DB 接続（secrets/.env.vm_prod.secrets に記載）
POSTGRES_DB=sanbou_prod
# DATABASE_URL=postgresql://sanbou_app_prod:<PASSWORD>@db:5432/sanbou_prod

# セキュリティ
DEBUG=false
IAP_ENABLED=true
# IAP_AUDIENCE=/projects/PROJECT_NUMBER/global/backendServices/SERVICE_ID

# GCS 同期
STARTUP_DOWNLOAD_ENABLE=
STRICT_STARTUP=false
GCS_LEDGER_BUCKET_PROD=gs://sanbouapp-prod/ledger_api/st_app

# Forecast Worker
POLL_INTERVAL=10

# ==== 参考資料 ===============================================================
# ・DB ユーザー設計: docs/db/20251204_db_user_design.md
# ・移行手順: docs/db/20251204_db_user_migration_plan.md
# ・SQL スクリプト: scripts/sql/20251204_create_app_db_users.sql
# ・GCP 認証: Application Default Credentials (ADC) を使用
#   - ローカル: gcloud auth application-default login
#   - GCE: VM にサービスアカウントをアタッチ


