###############################################
# .env.vm_stg (GCP VM ステージング環境) 旧: .env.stg
# - local_stg との差分: FQDN / ポート番号 (8080/8443) / PUBLIC_BASE_URL
###############################################

APP_TAG=stg
STAGE=stg
NODE_ENV=staging
PUBLIC_BASE_URL=https://stg.sanbou-app.jp

# === Security / Authentication ===
# ステージング環境: IAP 有効、DEBUG 無効推奨
DEBUG=false
IAP_ENABLED=true
# IAP_AUDIENCE は GCP プロジェクト設定後に設定
# 例: /projects/PROJECT_NUMBER/global/backendServices/SERVICE_ID
IAP_AUDIENCE=

# === DB ===
# 【DB ユーザー分離対応】
# POSTGRES_PASSWORD は secrets/.env.vm_stg.secrets に記載してください
# 推奨: sanbou_app_stg ユーザーを使用（scripts/sql/20251204_create_app_db_users.sql 参照）
#
# 注意: DATABASE_URL はパスワードから自動構築されます（URLエンコード済み）
POSTGRES_USER=sanbou_app_stg
POSTGRES_DB=sanbou_stg

# === GCP 認証 (ADC) ===
# Application Default Credentials を使用
# GCE VM にサービスアカウントをアタッチしてください
# GOOGLE_APPLICATION_CREDENTIALS 環境変数は不要です

# === RAG (rag_api) ===
# 優先される完全URI形式。例: gs://<bucket>/<service>/<object>/<prefix>/
RAG_GCS_URI=gs://sanbouapp-stg/rag_api/object_haikibutu/master/

# === ledger_api 同期 ===
STARTUP_DOWNLOAD_ENABLE=True
STRICT_STARTUP=false
GCS_LEDGER_BUCKET=
GCS_LEDGER_BUCKET_DEV=gs://sanbouapp-dev/ledger_api/st_app
GCS_LEDGER_BUCKET_STG=gs://sanbouapp-stg/ledger_api/st_app
GCS_LEDGER_BUCKET_PROD=gs://sanbouapp-prod/ledger_api/st_app

# === Nginx exposed ports ===
# STG nginx host ports
STG_NGINX_HTTP_PORT=80
STG_NGINX_HTTPS_PORT=443
# === Forecast Worker Settings ===
# ステージング環境では .env.common のデフォルト(5秒)を使用

# === メモ ===
# ・TLS 有効化時は nginx stg.conf の 443 server ブロックをアンコメント
# ・内部API URL (RAG_API_BASE等) は .env.common から継承
